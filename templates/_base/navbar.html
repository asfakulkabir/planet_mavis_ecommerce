{% load custom_tags %}
<section class="sticky top-0 z-40">
  <nav x-data="{ mobileMenuIsOpen: false }" x-on:click.away="mobileMenuIsOpen = false"
    class="flex items-center justify-between bg-white border-b border-gray-300 gap-4 px-6 py-4"
    aria-label="penguin ui menu">
    <!-- Brand Logo -->
    <a href="/" class="text-xl md:text-2xl lg:text-4xl font-bold text-gray-900">
      <span>Oshee<span class="text-pink-600">BD</span></span>
      <!-- <img src="./your-logo.svg" alt="brand logo" class="w-10" /> -->
    </a>

    <!-- Search -->
<form class="hidden relative md:flex mr-auto w-full max-w-full flex-col gap-1 text-gray-900 lg:mx-14 "  method="get" action="{% url 'website:search' %}">
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
    aria-hidden="true" class="absolute left-2.5 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400">
    <path stroke-linecap="round" stroke-linejoin="round"
      d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
  </svg>
  <input value="{{ search_query }}" id="searchInput" type="text" name="search" placeholder="Search" aria-label="search"  
    class="w-full rounded border border-gray-300 py-2.5 pl-10 pr-2 text-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-pink-600 disabled:cursor-not-allowed disabled:opacity-75  bg-gray-100" />
</form>
                                   



    <!-- Desktop Menu -->
    <ul class="hidden items-center gap-4 shrink-0 sm:flex">
      <li><a href="{% url 'website:shop' %}"
          class="font-medium text-pink-600 underline-offset-2 hover:text-pink-700 focus:outline-hidden focus:underline text-sm"
          aria-current="page">Shop</a></li>
      <li><a href="#"
          class="font-medium text-gray-700 underline-offset-2 hover:text-pink-700 focus:outline-hidden focus:underline text-sm">Pricing</a>
      </li>
      <li><a href="{% url 'website:wishlist_page' %}">
          <svg class="w-8 h-8" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" fill="none"
            stroke-width="1">
            <path
              d="M12.001 4.529c2.349-2.532 6.15-2.532 8.498 0 2.172 2.343 2.216 6.122.102 8.507l-7.507 7.934a1.125 1.125 0 01-1.628 0l-7.507-7.934C1.284 10.65 1.328 6.872 3.5 4.529c2.348-2.532 6.149-2.532 8.501 0z" />
          </svg></a>
      </li>
      <!-- User Pic -->
      <li x-data="{ userDropDownIsOpen: false, openWithKeyboard: false }"
        x-on:keydown.esc.window="userDropDownIsOpen = false, openWithKeyboard = false"
        x-on:mouseenter="userDropDownIsOpen = true" x-on:mouseleave="userDropDownIsOpen = false"
        class="relative flex items-center">
        <button x-bind:aria-expanded="userDropDownIsOpen"
          class="focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-pink-600"
          aria-controls="userMenu">
          <img src="/static/icons/people.png" alt="User Profile" class="h-8 w-8 object-cover cursor-pointer" />
        </button>
        <!-- User Dropdown -->
        <ul x-cloak x-show="userDropDownIsOpen || openWithKeyboard" x-transition.opacity x-trap="openWithKeyboard"
          x-on:click.outside="userDropDownIsOpen = false, openWithKeyboard = false"
          x-on:keydown.down.prevent="$focus.wrap().next()" x-on:keydown.up.prevent="$focus.wrap().previous()"
          id="userMenu"
          class="absolute right-0 top-12 flex w-fit min-w-48 flex-col overflow-hidden rounded border border-gray-300 bg-white py-1.5 z-30">
          <li class="border-b border-gray-300">
            <div class="flex flex-col px-4 py-2">
              <span class="text-sm font-medium text-gray-900">Alice Brown</span>
              <p class="text-xs text-gray-700">alice.brown@gmail.com</p>
            </div>
          </li>
          <li><a href="#"
              class="block bg-white px-4 py-2 text-sm text-gray-900 hover:bg-gray-50 hover:text-gray-900 focus-visible:bg-gray-100 focus-visible:text-gray-900 focus-visible:outline-hidden">Dashboard</a>
          </li>
          <li><a href="#"
              class="block bg-white px-4 py-2 text-sm text-gray-900 hover:bg-gray-50 hover:text-gray-900 focus-visible:bg-gray-100 focus-visible:text-gray-900 focus-visible:outline-hidden">Subscription</a>
          </li>
          <li><a href="#"
              class="block bg-white px-4 py-2 text-sm text-gray-900 hover:bg-gray-50 hover:text-gray-900 focus-visible:bg-gray-100 focus-visible:text-gray-900 focus-visible:outline-hidden">Settings</a>
          </li>
          <li><a href="#"
              class="block bg-white px-4 py-2 text-sm text-gray-900 hover:bg-gray-50 hover:text-gray-900 focus-visible:bg-gray-100 focus-visible:text-gray-900 focus-visible:outline-hidden">Sign
              Out</a></li>

        </ul>
      </li>

    </ul>

    <!-- Mobile Menu Button -->
    <div class="flex items-center gap-2 sm:hidden">
      <a href="{% url 'website:wishlist_page' %}">
        <svg class="w-6 h-6" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" fill="none"
          stroke-width="1">
          <path
            d="M12.001 4.529c2.349-2.532 6.15-2.532 8.498 0 2.172 2.343 2.216 6.122.102 8.507l-7.507 7.934a1.125 1.125 0 01-1.628 0l-7.507-7.934C1.284 10.65 1.328 6.872 3.5 4.529c2.348-2.532 6.149-2.532 8.501 0z" />
        </svg></a>
      <button x-on:click="mobileMenuIsOpen = !mobileMenuIsOpen" x-bind:aria-expanded="mobileMenuIsOpen"
        x-bind:class="mobileMenuIsOpen ? 'fixed top-6 right-6 z-20' : null" type="button"
        class="focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-pink-600"
        aria-controls="mobileMenu">
        <img x-show="!mobileMenuIsOpen" src="/static/icons/people.png" alt="User Profile"
          class="h-6 w-6 object-cover cursor-pointer" />
        <svg x-cloak x-show="mobileMenuIsOpen" xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true"
          viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="h-6 w-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
        </svg>
      </button>

      <section x-data="{ isMobileMenuOpen: false }">
    <button @click="isMobileMenuOpen = !isMobileMenuOpen"
        class="group text-gray-500 hover:text-gray-900 rounded-md transition-colors duration-200 text-center items-center flex justify-center">
        <svg x-show="!isMobileMenuOpen" class="h-6 w-6 transform transition-transform duration-300 group-hover:scale-110" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
        <svg x-show="isMobileMenuOpen" class="h-6 w-6 transform transition-transform duration-300 group-hover:rotate-90" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
    </button>

    <div x-cloak x-show="isMobileMenuOpen" x-transition:enter="transition ease-out duration-300 transform"
        x-transition:enter-start="-translate-x-full" x-transition:enter-end="translate-x-0"
        x-transition:leave="transition ease-in duration-200 transform" x-transition:leave-start="translate-x-0"
        x-transition:leave-end="-translate-x-full"
        class="fixed top-0 left-0 h-full w-64 md:w-72 bg-amber-50 shadow-xl overflow-y-auto z-[90]">

        <div class="p-4 border-b border-amber-100 flex justify-end sticky top-0 bg-amber-50 z-10">
            <button @click="isMobileMenuOpen = false"
                class="text-gray-500 hover:text-gray-900 rounded-md transition-colors duration-200">
                <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>

        <nav x-data="{ openParent: null, openGroup: null }" class="py-4 px-2">
            <ul>
                {% for parent in parent_categories %}
                <li class="border-b border-amber-100">
                    <div class="flex justify-between items-center p-3">
                        <a href="{% url 'website:category_detail' full_slug=parent.get_full_slug %}"
                            class="text-gray-700 hover:text-pink-600 font-normal flex-grow text-base transition-colors duration-200">
                            {{ parent.name }}
                        </a>
                        {% with structured_mega_menu|get_item:parent.id as menu_groups %}
                        {% if menu_groups %}
                        <button
                            @click="openParent = (openParent === {{ forloop.counter0 }} ? null : {{ forloop.counter0 }}); openGroup = null"
                            class="text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-amber-100 transition-colors duration-200">
                            <svg x-show="openParent !== {{ forloop.counter0 }}"
                                class="h-5 w-5 transform transition-transform duration-200" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                            <svg x-show="openParent === {{ forloop.counter0 }}"
                                class="h-5 w-5 transform rotate-90 transition-transform duration-200" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </button>
                        {% endif %}
                        {% endwith %}
                    </div>

                    {% with structured_mega_menu|get_item:parent.id as menu_groups %}
                    {% if menu_groups %}
                    <div x-show="openParent === {{ forloop.counter0 }}" x-collapse.duration.300ms class="bg-amber-100 pb-2">
                        <ul>
                            {% for group, categories in menu_groups.items %}
                            <li class="border-t border-amber-200">
                                <div class="flex justify-between items-center p-2 pl-6">
                                    <h4 class="font-normal text-gray-700 flex-grow text-sm">{{ group }}</h4>
                                    {% if categories %}
                                    <button @click="openGroup = (openGroup === '{{ group }}' ? null : '{{ group }}')"
                                        class="text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-amber-200 transition-colors duration-200">
                                        <svg x-show="openGroup !== '{{ group }}'"
                                            class="h-5 w-5 transform transition-transform duration-200" fill="none" viewBox="0 0 24 24"
                                            stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                        </svg>
                                        <svg x-show="openGroup === '{{ group }}'"
                                            class="h-5 w-5 transform rotate-90 transition-transform duration-200" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                        </svg>
                                    </button>
                                    {% endif %}
                                </div>
                                <div x-show="openGroup === '{{ group }}'" x-collapse.duration.300ms class="bg-amber-200 pb-2">
                                    <ul>
                                        {% for cat in categories %}
                                        <li>
                                            <a href="{% url 'website:category_detail' full_slug=cat.get_full_slug %}"
                                                class="block p-2 pl-10 text-gray-600 hover:text-pink-600 text-sm font-light transition-colors duration-200">
                                                {{ cat.name }}
                                            </a>
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    {% endwith %}
                </li>
                {% endfor %}
            </ul>
        </nav>
    </div>

    <div x-cloak x-show="isMobileMenuOpen" @click="isMobileMenuOpen = false"
        x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
        class="fixed inset-0 bg-black/70 z-[80]"></div>
      </section>

    </div>

    <!-- Mobile Menu -->
    <ul x-cloak x-show="mobileMenuIsOpen"
      x-transition:enter="transition motion-reduce:transition-none ease-out duration-300"
      x-transition:enter-start="-translate-y-full" x-transition:enter-end="translate-y-0"
      x-transition:leave="transition motion-reduce:transition-none ease-out duration-300"
      x-transition:leave-start="translate-y-0" x-transition:leave-end="-translate-y-full"
      class="fixed max-h-screen overflow-y-auto inset-x-0 top-0 z-10 flex flex-col rounded-b border-b border-gray-300 bg-white px-8 pb-6 pt-10 sm:hidden">
      <li class="mb-4 border-none">
        <div class="flex items-center gap-2 py-2">
          <img src="https://penguinui.s3.amazonaws.com/component-assets/avatar-8.webp" alt="User Profile"
            class="h-12 w-12 rounded-full object-cover" />
          <div>
            <span class="font-medium text-gray-900">Alice Brown</span>
            <p class="text-sm text-gray-700">alice.brown@gmail.com</p>
          </div>
        </div>
      </li>
      <li class="p-2"><a href="#" class="w-full text-lg font-bold text-pink-600 focus:underline"
          aria-current="page">Products</a></li>
      <li class="p-2"><a href="#" class="w-full text-lg font-medium text-gray-700 focus:underline">Pricing</a></li>
      <li class="p-2"><a href="#" class="w-full text-lg font-medium text-gray-700 focus:underline">Blog</a></li>
      <hr role="none" class="my-2 border-gray-300">
      <li class="p-2"><a href="#" class="w-full text-gray-900 focus:underline">Dashboard</a></li>
      <li class="p-2"><a href="#" class="w-full text-gray-900 focus:underline">Subscription</a></li>
      <li class="p-2"><a href="#" class="w-full text-gray-900 focus:underline">Settings</a></li>
      <!-- CTA Button -->
      <li class="mt-4 w-full border-none"><a href="#"
          class="rounded bg-pink-600 border border-pink-600 px-4 py-2 block text-center font-medium tracking-wide text-white hover:opacity-75 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-pink-600 active:opacity-100 active:outline-offset-0">Sign
          Out</a></li>
    </ul>
  </nav>

  
  <nav class="bg-white border-b border-b-slate-400 w-full hidden lg:block" x-data="{ openIndex: null }"
    style="position: relative;">
    <div class="max-w-7xl mx-auto px-4">

      <!-- Wrap both parent menu and mega menu for consistent hover -->
      <div @mouseenter="openIndex = openIndex" @mouseleave="openIndex = null">
        <!-- Parent menu centered -->
        <ul class="flex justify-center space-x-8 xl:space-x-14 py-4">
          {% for parent in parent_categories %}
          {% with structured_mega_menu|get_item:parent.id as menu_groups %}
          <li class="cursor-pointer" {% if menu_groups %} @mouseenter="openIndex = {{ forloop.counter0 }}" {% endif %}>
            <a href="{% url 'website:category_detail' full_slug=parent.get_full_slug %}"
              class="text-sm hover:text-pink-600">
              {{ parent.name }}
            </a>
          </li>
          {% endwith %}
          {% endfor %}
        </ul>

        <!-- Mega Menu container -->
        <div x-show="openIndex !== null" x-transition
          class="absolute left-0 top-full w-full bg-white border-t border-b border-slate-300 shadow z-20"
          style="min-height: 250px;">
          <div class="w-full mx-auto px-6 py-8 grid grid-cols-5 gap-8">
            {% for parent in parent_categories %}
            {% with structured_mega_menu|get_item:parent.id as menu_groups %}
            {% if menu_groups %}
            <template x-if="openIndex === {{ forloop.counter0 }}">
              <div class="col-span-5 grid grid-cols-5 gap-6">
                <div class="col-span-4 grid grid-cols-4 gap-6">
                  {% for group, categories in menu_groups.items %}
                  <div>
                    <h4 class="font-semibold text-gray-700 mb-3 uppercase">{{ group }}</h4>
                    <ul>
                      {% for cat in categories %}
                      <li>
                        <a href="{% url 'website:category_detail' full_slug=cat.get_full_slug %}"
                          class="text-gray-600 hover:text-pink-600 block">
                          {{ cat.name }}
                        </a>
                      </li>
                      {% endfor %}
                    </ul>
                  </div>
                  {% endfor %}
                </div>
                <div class="hidden md:flex col-span-1 items-end">
                  <img
                    src="{% if parent.image %}{{ parent.image.url }}{% else %}/static/icons/default-image.webp{% endif %}"
                    alt="{{ parent.name }}" class="w-full rounded object-contain h-48" />
                </div>
              </div>
            </template>
            {% endif %}
            {% endwith %}
            {% endfor %}
          </div>
        </div>


      </div>

    </div>
  </nav>

  <section>


  </section>


  <!-- Search -->
  <form method="get" action="{% url 'website:search' %}">
    <div class="relative flex mr-auto w-full max-w-full flex-col gap-1 text-gray-900 lg:mx-14 md:hidden">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
        aria-hidden="true" class="absolute left-2.5 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
      </svg>
      <input value="{{ search_query }}" type="text" name="search" placeholder="Search" aria-label="search"
        class="w-full rounded border border-gray-300 bg-gray-100 py-2.5 pl-10 pr-2 text-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-pink-600 disabled:cursor-not-allowed disabled:opacity-75" />
    </div>
  </form >
</section>





<script>
  const phrases = ["Search by keywords", "sharee", "women", "kamij"];
  let currentPhrase = 0;
  let currentChar = 0;
  const input = document.getElementById("searchInput");

  function type() {
    if (currentChar <= phrases[currentPhrase].length) {
      input.placeholder = phrases[currentPhrase].substring(0, currentChar++);
      setTimeout(type, 100);
    } else {
      setTimeout(erase, 1500);
    }
  }

  function erase() {
    if (currentChar > 0) {
      input.placeholder = phrases[currentPhrase].substring(0, --currentChar);
      setTimeout(erase, 50);
    } else {
      currentPhrase = (currentPhrase + 1) % phrases.length;
      setTimeout(type, 300);
    }
  }

  window.addEventListener("DOMContentLoaded", type);

</script>